<!-- Created by mumblebaj -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Universal Schema Studio</title>
    <link rel="stylesheet" href="css/openapiEditor.css" />
    <link rel="icon" type="image/svg+xml" href="./favicon.svg" />
    <link rel="icon" type="image/png" href="./favicon.png" />

    <!-- YAML Parser -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"
      defer
    ></script>
    <!-- ReDoc -->
    <script src="https://cdn.jsdelivr.net/npm/redoc@2.1.3/bundles/redoc.standalone.min.js"></script>
    <!-- Swagger Client (must load BEFORE Monaco to avoid AMD trap) -->
    <script src="./js/swagger-client.browser.min.js" defer></script>
    <!-- Monaco CDN -->
    <script
      src="https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs/loader.js"
      defer
    ></script>
  </head>
  <body class="openapi-editor">
<div class="toolbar">
  <button onclick="validateOpenAPI()">Validate</button>
  <button onclick="exportYAML()">Export YAML</button>
  <button onclick="exportJSON()">Export JSON</button>

  <!-- ðŸŒ“ Theme selector -->
  <label for="themeSelect" style="margin-left: 1rem; font-weight: 500;">Theme:</label>
  <select id="themeSelect">
    <option value="vs">Visual Studio (Light)</option>
    <option value="vs-dark">Visual Studio Dark</option>
    <option value="hc-black">High Contrast Dark</option>
  </select>

  <span id="status" style="margin-left: auto"></span>
</div>


    <div class="editor-layout">
      <div id="yamlEditor"></div>
      <div id="dragbar"></div>
      <div id="previewPane"></div>
    </div>

    <script type="module" src="./js/openapiEditor.js" defer></script>

    <script>
      // --- Dragbar Resizing Logic with Persistence ---
      const dragbar = document.getElementById("dragbar");
      const leftPane = document.getElementById("yamlEditor");
      let isDragging = false;

      // Restore previous width from localStorage (default 50%)
      const savedWidth = localStorage.getItem("editorPaneWidth");
      if (savedWidth) {
        leftPane.style.flex = `0 0 ${savedWidth}`;
      } else {
        leftPane.style.flex = "0 0 50%";
      }

      dragbar.addEventListener("mousedown", () => (isDragging = true));
      document.addEventListener("mouseup", () => (isDragging = false));
      document.addEventListener("mousemove", (e) => {
        if (!isDragging) return;
        const containerWidth = dragbar.parentNode.offsetWidth;
        const newRatio = Math.min(
          Math.max(e.clientX / containerWidth, 0.25),
          0.75
        );
        const newWidth = `${(newRatio * 100).toFixed(2)}%`;

        leftPane.style.flex = `0 0 ${newWidth}`;

        // Save the new width for persistence
        localStorage.setItem("editorPaneWidth", newWidth);
      });
    </script>
  </body>
</html>
